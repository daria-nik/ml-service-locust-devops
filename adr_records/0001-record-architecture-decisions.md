# 1. Почему мы выбрали такую архитектуру

Дата: 2025-11-29

## Контекст

Создаваемый сервис должен выполнять:
- предсказания модели (эндпоинт `/predict`)
- проверку доступности (`/healthcheck`)
- анализ дрейфа данных (`/drift`)

Также сервис должен быть воспроизводимым, запускаться внутри контейнера, быть совместимым с нагрузочным тестированием Locust и поддерживать CI/CD.

Мы рассматриваем две возможные архитектурные альтернативы.


## Альтернатива A — Монолитный сервис FastAPI  
**Описание:**  
Один контейнер, один сервер FastAPI, в котором реализованы все эндпоинты и вся логика.

**Плюсы:**
- минимальная сложность развертывания  
- быстрее разработка  
- проще тестирование  
- меньше накладных расходов  

**Минусы:**
- сложно масштабировать отдельные компоненты  
- логика дрейфа и предсказаний связана в одном месте  
- усложнение кода при росте проекта  


## Альтернатива B — Микросервисная архитектура  
**Описание:**  
Отдельный сервис для ML-предсказаний + отдельный сервис для оценки качества данных (дрифт).

**Плюсы:**
- независимое масштабирование сервисов  
- четкое разделение ответственности  
- проще поддерживать большие проекты  

**Минусы:**
- нужна отдельная сеть между сервисами  
- сложнее разворачивать и тестировать  
- выше стоимость инфраструктуры  


## Решение

Мы выбираем **Альтернативу A — Монолитный FastAPI-сервис**.

Причины выбора:
- задание требует простоты и воспроизводимости
- сервис должен запускаться «с нуля» в одном контейнере
- нагрузочные тесты проще проводить на одном эндпоинте
- drfit и predict используют одинаковые библиотеки, упрощается окружение


## Последствия

Положительные:
- простой деплой через Docker
- высокая скорость разработки
- один endpoint-host для Locust

Отрицательные:
- при росте системы потребуется рефакторинг в сторону микросервисов
- нельзя независимо масштабировать подсистему дрейфа


## Статус  
**Принято**


